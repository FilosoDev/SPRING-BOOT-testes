package com.AppRH.AppRH.controllers;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.servlet.ModelAndView;

import com.AppRH.AppRH.models.Dependentes;
import com.AppRH.AppRH.models.Funcionario;
import com.AppRH.AppRH.repository.DependentesRepository;
import com.AppRH.AppRH.repository.FuncionarioRepository;

public class PesquisarController {

	@Autowired
	private FuncionarioRepository fr;
	
	private DependentesRepository dr;
	
	@RequestMapping("/buscar")
	public ModelAndView listaPesquisar() {
		ModelAndView mv = new ModelAndView("funcionario/pesquisar");
		return mv;
	}
	
	@PostMapping("/buscar")
	public ModelAndView pesquisarFuncionario(@RequestParam("nome") String nome, @RequestParam("busca") String busca) {
		
		ModelAndView mv = new ModelAndView("funcionario/pesquisar");
		
		if(busca.equals("nomefuncionario")) {
			
			Funcionario funcionario = fr.findByNome(nome);
			mv.addObject("funcionario", funcionario);

			Iterable<Dependentes> dependentes = dr.findByFuncionario(funcionario);
			mv.addObject("dependentes", dependentes);

			mv.addObject("contador", (funcionario != null) ? 1 : 0);
		}
		
		return;
		
	}
	
	
	
	
	
	
}
